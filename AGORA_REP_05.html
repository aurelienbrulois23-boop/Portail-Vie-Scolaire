<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AGORA | AG_R05 ‚Äî Du d√©l√©gu√© au d√©put√©</title>
<script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
<script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Montserrat:wght@400;600;700&family=Share+Tech+Mono&display=swap');
:root{--bg:#0f172a;--panel:#1e293b;--acc:#38bdf8;--acc-d:#0284c7;--text:#f8fafc;--muted:#94a3b8;--border:#334155}
*{box-sizing:border-box;margin:0;padding:0}
body{font-family:'Montserrat',sans-serif;background:var(--bg);color:var(--text);min-height:100vh;
  display:flex;justify-content:center;align-items:flex-start;padding:32px 16px 60px}
body::before{content:'';position:fixed;inset:0;pointer-events:none;z-index:0;
  background:radial-gradient(ellipse at 50% 0%,rgba(56,189,248,0.1) 0%,transparent 55%)}
#root{width:100%;max-width:820px;position:relative;z-index:1}
.card{background:rgba(15,23,42,0.92);border:2px solid var(--acc);padding:36px 40px;border-radius:6px;
  box-shadow:0 0 50px rgba(0,0,0,0.7),0 0 80px rgba(56,189,248,0.1);backdrop-filter:blur(10px);position:relative;overflow:hidden}
.card::before{content:'AGORA';position:absolute;top:-20px;right:-10px;font-family:'Playfair Display';
  font-size:5rem;opacity:0.04;transform:rotate(-12deg);color:var(--acc);pointer-events:none}
h1,h2{font-family:'Playfair Display',serif;color:var(--acc);text-align:center;margin-bottom:14px}
h1{font-size:1.55rem}h2{font-size:1.2rem}
p{line-height:1.75;margin-bottom:12px;color:#d8e8f8}
.quote{font-style:italic;color:var(--muted);border-left:3px solid var(--acc);padding-left:14px;margin-bottom:18px;line-height:1.7}
.tag{font-size:0.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:1.5px;
  font-family:'Share Tech Mono',monospace;margin-bottom:12px;text-align:center}
.name-input{width:100%;padding:12px 14px;background:#000;border:1px solid var(--acc);
  color:var(--acc);font-family:'Share Tech Mono',monospace;border-radius:3px;outline:none;
  margin-bottom:14px;transition:border-color .2s;font-size:0.88rem}
.name-input:focus{border-color:#fff}
.xp-badge{display:inline-flex;align-items:center;gap:6px;background:rgba(255,215,0,0.08);
  border:1px solid rgba(255,215,0,0.25);padding:4px 12px;border-radius:20px;
  font-size:0.7rem;color:#ffd700;font-family:'Share Tech Mono',monospace;
  margin:8px auto 0;display:block;width:fit-content}
.btn{background:var(--acc);color:#000;border:none;padding:13px 28px;font-weight:700;
  text-transform:uppercase;letter-spacing:.5px;cursor:pointer;transition:.25s;
  display:block;margin:18px auto 0;border-radius:4px}
.btn:hover{filter:brightness(1.12);transform:translateY(-2px);box-shadow:0 6px 20px rgba(56,189,248,0.1)}
.progress{height:3px;background:rgba(255,255,255,0.07);margin-bottom:24px;border-radius:2px;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,var(--acc-d),var(--acc));
  border-radius:2px;transition:width .5s ease}
.step-tag{font-family:'Share Tech Mono',monospace;font-size:0.62rem;color:var(--muted);
  text-transform:uppercase;letter-spacing:1px;margin-bottom:10px}
.opt{display:block;width:100%;text-align:left;background:rgba(255,255,255,0.04);
  border:1px solid rgba(255,255,255,0.1);color:var(--text);padding:16px 18px;margin:10px 0;
  cursor:pointer;transition:.22s;border-radius:4px;font-size:0.88rem;line-height:1.5}
.opt:hover{background:rgba(255,255,255,0.09);border-color:var(--acc)}
.summary-box{background:rgba(255,255,255,0.03);border-left:3px solid var(--acc);
  padding:16px 18px;margin:16px 0;line-height:1.75}
.summary-box p{margin-bottom:8px;font-size:0.85rem;color:#c0d4e8}
.summary-box p:last-child{margin-bottom:0}
.token-box{background:#000;color:var(--acc);font-family:'Share Tech Mono',monospace;
  padding:16px;border:1px dashed var(--acc);word-break:break-all;margin:18px 0;
  font-size:0.8rem;border-radius:3px;cursor:text;user-select:all;line-height:1.6}
.token-note{font-size:0.72rem;color:var(--muted);line-height:1.65;margin-top:4px}
.seal{text-align:center;font-size:2.8rem;margin:14px 0}
.nav-back{background:rgba(255,255,255,0.05);border:1px solid var(--border);
  color:var(--muted);padding:6px 12px;cursor:pointer;border-radius:3px;
  font-size:0.7rem;font-family:'Montserrat',sans-serif;font-weight:600;
  transition:.2s;margin-bottom:18px}
.nav-back:hover{background:rgba(255,255,255,0.09);color:#fff}
</style>
</head>
<body>
<div id="root"></div>
<script>
const e = React.createElement;
const MODULE_ID = "AG_R05";
const CERT_KEY  = "CERT_REPUBLIQUE_5";
const XP_AMOUNT = 75;
const BACK_URL  = "index_PIX_DELEGUES.html";
const QUESTIONS = [{"q": "Le CVC (Conseil de Vie Coll√©gienne) est l'√©quivalent scolaire de...", "a": ["Le S√©nat ‚Äî car compos√© de repr√©sentants indirects", "L'Assembl√©e nationale ‚Äî car membres √©lus directement par leurs pairs", "Le Conseil d'√âtat ‚Äî car il donne des avis sur les r√®glements"], "c": 1, "wrong": "Le CVC = repr√©sentants √©lus directement par les √©l√®ves. M√™me logique que l'AN √©lue directement par les citoyens."}, {"q": "Pour devenir d√©put√©, quelles sont les conditions principales ?", "a": ["30 ans minimum, √™tre magistrat ou professeur, passer un concours", "18 ans minimum, nationalit√© fran√ßaise, √™tre √©lu au suffrage universel direct dans sa circonscription", "Avoir √©t√© ministre et √™tre parrain√© par 500 √©lus"], "c": 1, "wrong": "18 ans, nationalit√© fran√ßaise, √©lection directe. Pas de dipl√¥me requis ‚Äî la l√©gitimit√© vient du vote des citoyens."}, {"q": "Un probl√®me dans ta classe peut remonter au niveau national via...", "a": ["Uniquement une p√©tition sur les r√©seaux", "D√©l√©gu√© ‚Üí CVC ‚Üí Parlement des lyc√©ens ‚Üí instances nationales ‚Üí parlementaires", "Directement en √©crivant au Pr√©sident"], "c": 1, "wrong": "C'est la cha√Æne institutionnelle. Lente mais l√©gitime et tra√ßable. Chaque maillon compte."}];
const SCENARIO  = {"title": "Le bilan", "p": "√Ä la fin de ton mandat, un nouvel √©lu te demande : \"√Ä quoi √ßa sert d'√™tre d√©l√©gu√© si on n'a pas vraiment de pouvoir ?\"", "options": [{"text": "\"Tu as un mandat, des instances reconnues par la loi, la capacit√© de faire remonter des probl√®mes r√©els qui changent des choses concr√®tes. Et tu t'entra√Ænes √† la citoyennet√© active, √† 13 ans, dans un pays qui en a besoin. C'est pas du pouvoir √ßa ? C'est le d√©but du pouvoir.\"", "ok": true, "fb": ""}, {"text": "\"C'est vrai, on n'a pas vraiment de pouvoir.\"", "ok": false, "fb": "Ce d√©faitisme est compr√©hensible mais faux. Un d√©l√©gu√© qui pense √ßa n'exerce pas son r√¥le ‚Äî et effectivement finit par ne pas avoir de pouvoir."}, {"text": "\"√áa sert √† avoir une bonne mention sur Parcoursup.\"", "ok": false, "fb": "Si c'est la seule raison, tu n'as rien retenu. √ätre d√©l√©gu√© c'est h√©riter de 2500 ans de d√©mocratie. Pas cocher une case."}]};
const SYNTHESIS = [{"icon": "üîó", "t": "La cha√Æne :", "v": "Classe ‚Üí CVC ‚Üí Parlement des lyc√©ens ‚Üí instances nationales ‚Üí Parlement. Chaque maillon compte."}, {"icon": "üó≥Ô∏è", "t": "Devenir d√©put√© :", "v": "18 ans, nationalit√© fran√ßaise, √©lection directe. Pas de dipl√¥me ‚Äî la l√©gitimit√© vient du vote."}, {"icon": "üí™", "t": "Ton pouvoir r√©el :", "v": "Mandat, instances l√©gales, capacit√© √† faire remonter et changer les choses. C'est le d√©but."}, {"icon": "üèõÔ∏è", "t": "L'h√©ritage total :", "v": "Ath√®nes 508 av. J.-C. ‚Üí Rome ‚Üí 1789 ‚Üí 1958 ‚Üí Toi, d√©l√©gu√©, aujourd'hui. Une seule et m√™me histoire."}];

function awardXP(name) {
  try {
    const raw   = localStorage.getItem('pvs_bridge_events');
    const evts  = raw ? JSON.parse(raw) : [];
    const player = localStorage.getItem('pvs_current_player') || name || 'inconnu';
    evts.push({
      id:     'AGORA-' + MODULE_ID + '-' + Date.now(),
      type:   'AGORA_MODULE_COMPLETE',
      player: player,
      module: MODULE_ID,
      label:  'AGORA : Du d√©l√©gu√© au d√©put√©',
      reward: XP_AMOUNT,
      d:      new Date().toISOString()
    });
    if (evts.length > 700) evts.splice(0, evts.length - 700);
    localStorage.setItem('pvs_bridge_events', JSON.stringify(evts));
  } catch(err) {}
}

function App() {
  const [step,    setStep]    = React.useState('intro');
  const [name,    setName]    = React.useState('');
  const [qIdx,    setQIdx]    = React.useState(0);
  const [token,   setToken]   = React.useState('');

  const finish = () => {
    const cert = { v:2, d:new Date().toISOString(), m:MODULE_ID, n:name||'D√©l√©gu√©', f:true };
    localStorage.setItem(CERT_KEY, JSON.stringify(cert));
    awardXP(name);
    setToken(btoa(unescape(encodeURIComponent(JSON.stringify(cert)))));
    setStep('complete');
  };

  const goBack = () => { window.location.href = BACK_URL; };

  /* ‚îÄ‚îÄ INTRO ‚îÄ‚îÄ */
  const renderIntro = () => e('div', {className:'card'},
    e('button', {className:'nav-back', onClick:goBack}, '‚Üê Agora'),
    e('div', {className:'tag'}, "La Ve R\u00e9publique \u00b7 Module 5/5 \u2726 CERTIFICATION"),
    
    e('h1', null, "Du d√©l√©gu√© au d√©put√©"),
    e('p', {className:'quote'}, "¬´ La politique est trop s√©rieuse pour √™tre laiss√©e aux seuls politiques. ¬ª ‚Äî Charles de Gaulle"),
    e('p', null, "Ce module fait le lien entre tout ce que tu viens d'apprendre et ton r√¥le concret. Il existe une cha√Æne de repr√©sentation qui va de ta classe au Parlement national : d√©l√©gu√© ‚Üí CVC ‚Üí Parlement des lyc√©ens ‚Üí instances nationales ‚Üí parlementaires."),
    e('p', null, "Tu n'es pas 'juste' un d√©l√©gu√© de coll√®ge. Tu es le premier √©chelon d'un syst√®me qui monte jusqu'aux plus hautes instances du pays. Ce n'est pas une m√©taphore ‚Äî c'est institutionnellement vrai."),

    e('input', {className:'name-input', type:'text', placeholder:"Ton nom pour le dipl\u00f4me final...",
      autoComplete:'off', onChange: ev => setName(ev.target.value)}),
    e('div', {className:'xp-badge'}, '‚ö° +75 XP √† la cl√©'),
    e('button', {className:'btn', onClick: () => {
      if (!name.trim()) { alert("Ce dipl\u00f4me a besoin d'un nom !"); return; }
      setStep('quiz');
    }}, "Tracer la cha\u00eene")
  );

  /* ‚îÄ‚îÄ QUIZ ‚îÄ‚îÄ */
  const renderQuiz = () => {
    const q   = QUESTIONS[qIdx];
    const pct = 25 + Math.round((qIdx / QUESTIONS.length) * 30);
    return e('div', {className:'card'},
      e('div', {className:'progress'}, e('div', {className:'progress-fill', style:{width:pct+'%'}})),
      e('div', {className:'step-tag'}, 'Question ' + (qIdx+1) + ' / ' + QUESTIONS.length),
      e('h2', null, q.q),
      q.a.map((opt, i) => e('button', {
        key:i, className:'opt',
        onClick: () => {
          if (i === q.c) {
            if (qIdx < QUESTIONS.length - 1) setQIdx(qIdx + 1);
            else setStep('scenario');
          } else {
            alert(q.wrong || "La cha\u00eene de repr\u00e9sentation est pr\u00e9cise. R\u00e9essaie.");
          }
        }
      }, opt))
    );
  };

  /* ‚îÄ‚îÄ SCENARIO ‚îÄ‚îÄ */
  const renderScenario = () => e('div', {className:'card'},
    e('div', {className:'progress'}, e('div', {className:'progress-fill', style:{width:'70%'}})),
    e('div', {className:'step-tag'}, 'Mise en situation'),
    e('h2', null, SCENARIO.title),
    e('p', null, SCENARIO.p),
    SCENARIO.options.map((opt, i) => e('button', {
      key:i, className:'opt',
      onClick: () => {
        if (opt.ok) setStep('synthesis');
        else alert(opt.fb);
      }
    }, opt.text))
  );

  /* ‚îÄ‚îÄ SYNTHESIS ‚îÄ‚îÄ */
  const renderSynthesis = () => e('div', {className:'card'},
    e('div', {className:'progress'}, e('div', {className:'progress-fill', style:{width:'88%'}})),
    e('div', {className:'step-tag'}, 'Synth√®se'),
    e('h2', null, 'Ce qu\'il faut retenir'),
    e('div', {className:'summary-box'},
      SYNTHESIS.map((s,i) => e('p', {key:i},
        e('strong', null, s.icon + ' ' + s.t + ' '), s.v
      ))
    ),
    e('button', {className:'btn', onClick:finish}, 'Valider ce module ‚Üí')
  );

  /* ‚îÄ‚îÄ COMPLETE ‚îÄ‚îÄ */
  const renderComplete = () => e('div', {className:'card'},
    e('div', {className:'seal'}, "\ud83d\uddf3\ufe0f"),
    e('h1', null, "Pilier La Ve R\u00e9publique \u2014 Valid\u00e9 !"),
    e('p', {style:{textAlign:'center'}}, "La cha\u00eene de repr\u00e9sentation n'a plus de secrets pour toi, ", e('strong', null, name), ' !'),
    e('div', {style:{textAlign:'center'}}, e('div', {className:'xp-badge'}, '‚ö° +' + XP_AMOUNT + ' XP envoy√©s au Portail')),
    e('p', {style:{textAlign:'center',color:'var(--muted)',fontSize:'.8rem',marginTop:'10px'}},
      'Copie le jeton ci-dessous et colle-le dans l\'Agora.'),
    e('div', {className:'token-box'}, token),
    e('p', {className:'token-note'}, 'üìã S√©lectionne tout le code (clic dans la zone) et copie-le ‚Äî Ctrl+C ou Cmd+C.'),
    e('button', {className:'btn', onClick:goBack}, '‚Üê Retour √† l\'Agora')
  );

  switch(step) {
    case 'intro':     return renderIntro();
    case 'quiz':      return renderQuiz();
    case 'scenario':  return renderScenario();
    case 'synthesis': return renderSynthesis();
    case 'complete':  return renderComplete();
    default:          return renderIntro();
  }
}

ReactDOM.createRoot(document.getElementById('root')).render(e(App));
</script>
</body>
</html>